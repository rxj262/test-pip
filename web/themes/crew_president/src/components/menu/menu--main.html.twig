{{ attach_library('crew_president/menu') }}

<button class="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i>Navigation + Search</button>

{% import _self as menus %}

{{ menus.menu_links(items, attributes, 0) }}

{% macro menu_links(items, attributes, menu_level) %}
  {% import _self as menus %}
  {% if items %}
    {% if menu_level == 0 %}
      <ul{{ attributes.addClass('menu-top-level container') }}>
      <form action="//www.case.edu/search-results/" class="menu-search-mobile" name="searchForm" role="search" aria-label="mobile search">
        <div class="input-group">
          <input placeholder="Search CWRU..." title="searchbox" type="search" class="mobile-search-input" name="q" maxlength="128" size="15" onfocus="if(!this._haschanged){this.value=''};this._haschanged=true;">
          <span class="mobile-search-btn-wrapper">
            <button type="submit" class="mobile-search-btn" aria-label="Submit Search">
              <span class="sr-only">Search</span>
              <span class="fa fa-search" aria-hidden="true"></span>
            </button>
          </span>
          <input type="hidden" name="cx" value="004305171799132815236:ciq4c8b3yv4">
          <input type="hidden" name="ie" value="UTF-8">
          <input class="hidden" role="button" name="sa" type="submit" title="search" alt="search">
        </div>
      </form>
    {% else %}
      <ul class="menu-dropdown">
    {% endif %}
    {% for item in items %}
      {% if item.is_expanded and menu_level == 0 %}
        <li{{ item.attributes.addClass('menu-item', 'dropdown') }} role="menuitem" tabindex="-1">
          <a href="{{ item.url }}" class="menu-link">{{ item.title }} <span class="arrow" aria-haspopup="true"></span></a>
          {% if item.below %}
            {{ menus.menu_links(item.below, attributes, menu_level + 1) }}
          {% endif %}
        </li>
      {% else %}
        <li{{ item.attributes.addClass('menu-item') }}>
          {{ link(item.title, item.url, {'class':['menu-link']}) }}
        </li>
      {% endif %}
    {% endfor %}
    </ul>
  {% endif %}
{% endmacro %}
